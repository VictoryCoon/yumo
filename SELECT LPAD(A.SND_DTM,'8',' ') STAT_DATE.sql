SELECT LPAD(A.SND_DTM,'8',' ') STAT_DATE
     , A.APP_ID
     , A.CAMP_ID
     , A.CAMP_PART_NO
     , A.RCV_OS_CD
     , NVL(B.GNDR_CD, '0') GNDR_CD
     , NVL(B.AGE_SCTN_DTL_CD,'0') AGE_SCTN_DTL_CD
     , COUNT(*) SND_CNT
     , SUM(CASE WHEN MSG_ST_TP_CD = '4' AND RSLT_TP_CD = '1000' THEN 1 ELSE 0 END) RCV_CNT
     , SUM(CASE WHEN MSG_ST_TP_CD = '4' AND MSG_CNF_TP_CD = '9' AND RSLT_TP_CD = '1000' THEN 1 ELSE 0 END) CNF_CNT
     , SUM(CASE WHEN ( MSG_ST_TP_CD = '5' OR MSG_ST_TP_CD = '6' ) THEN 1 ELSE 0 END) FAIL_CNT
     , SUM(CASE WHEN MSG_ST_TP_CD = '1' AND RSLT_TP_CD = '1000' THEN 1 ELSE 0 END) ETC_CNT
  FROM (SELECT * FROM TBPUSH_SND_LOG WHERE CAMP_ID <>'0') A
     , TBPUSH_CAMP_TGT_USER B
 WHERE 1=1
   AND A.CAMP_ID = B.CAMP_ID 
   AND A.RCV_TKN_VAL=B.RCV_TKN_VAL
   AND A.SND_DTM >= CONCAT(TO_CHAR(SYSDATE-2, 'YYYYMMDD'),'000000')
   AND A.SND_DTM < CONCAT(TO_CHAR(SYSDATE, 'YYYYMMDDHH'), '0000')
   AND A.SND_TP_CD = '2'
 GROUP BY LPAD(A.SND_DTM,'8',' ')
      , A.APP_ID
      , A.CAMP_ID
      , A.CAMP_PART_NO
      , A.RCV_OS_CD
      , B.GNDR_CD
      , B.AGE_SCTN_DTL_CD;

UPDATE /*+ INDEX(TBPUSH_SND_LOG UK_TBPUSH_SND_LOG)*/ TBPUSH_SND_LOG
   SET RSLT_TP_CD = '1000'
     , MSG_ST_TP_CD = '4'
     , RCV_DTM = '20211027153044'
     , GCM_SND_CNT = 1
 WHERE INPUT_DT = SUBSTR('20211013',1,8)
   AND PUSH_ID = '20211013151209202110'
   AND RSLT_TP_CD = '1000'
   AND MSG_ST_TP_CD = '4';

UPDATE TBPUSH_SND_LOG
   SET RSLT_TP_CD = '1000'
     , MSG_ST_TP_CD = '4'
     , RCV_DTM = '20211027153044'
     , GCM_SND_CNT = 1
 WHERE INPUT_DT = SUBSTR('20211013',1,8)
   AND PUSH_ID = '20211013151209202110'
   AND RSLT_TP_CD = '1000'
   AND MSG_ST_TP_CD = '4';

SELECT RSLT_TP_CD, MSG_ST_TP_CD, RCV_DTM, GCM_SND_CNT FROM TBPUSH_SND_LOG 
 WHERE PUSH_ID = '20211013151209202110';

SELECT RSLT_TP_CD, MSG_ST_TP_CD, RCV_DTM, GCM_SND_CNT FROM TBPUSH_SND_LOG 
 WHERE INPUT_DT = SUBSTR('20211013',1,8)
   AND PUSH_ID = '20211013151209202110'
   AND RSLT_TP_CD = '1000'
   AND MSG_ST_TP_CD = '4';